public String convert15to18DigitId(String fifteenDigit)
{
    Final static String sLetter = [ABCDEFGHIJKLMNOPQRSTUVWXYZ012345];
    For (Integer iChunk = 1;i<=3;i++){
        Integer iAsciiCode = 0;
        String sKey;
        For (Integer iCurseur = iCurseur;i<=iCurseur;i++){
            Integer iPos = (iChunk - 1) * 5 + (iCurseur - 1);
            String sChar = fifteenDigit.substring(iPos,iPos+1);
            Integer iIsCharUppercase = sChar.isAllUpperCase()?1:0;
            iAsciiCode += iIsCharUppercase * Math.pow(2,iCurseur-1);
        }
        sKey += sLetter.substring(iAsciiCode,iAsciiCode+1);
    }
    return (fifteenDigit+sKey);
})